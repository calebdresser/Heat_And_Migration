# Caleb Dresser
# BIDMC / HSPH / FXB

# Lets read in the data file
heat <- read.csv (file = file.choose())

# peek at the data
head(heat)

# lets plot warming since 1960 (independent variable) against hypothesized
# dependent variable of emigration ratio (ie. number of people born in the nation in question
# divided by the total population of the origin nation)

p1 <- ggplot(data = heat, aes( x = heat$Warming2013, y = heat$EmigrationRatio))
p2 <- p1 + geom_point(aes(color = factor(heat$Continent), shape = factor(heat$IslandTerritories)))
p2

p1 <- ggplot(data = heat, aes( x = heat$Warming2013, y = heat$EmigrationRatio))
p2 <- p1 + geom_point(aes(color = factor(heat$IslandTerritories)))
p2

p1 <- ggplot(data = heat, aes( x = heat$Warming2013, y = heat$EmigrationRatio))
p2 <- p1 + geom_point(aes(color = factor(heat$Continent)))
p2

p1 <- ggplot(data = heat, aes( x = heat$Warming2013, y = heat$EmigrationRatio))
p2 <- p1 + geom_point(aes(color = factor(heat$Continent))) + geom_smooth(mapping = aes( linetype = Continent))
p2

p1 <- ggplot(data = heat, aes( x = heat$Warming2013, y = heat$EmigrationRatio))
p2 <- p1 + geom_point(aes(color = factor(heat$IslandTerritories))) + geom_smooth(mapping = aes( linetype = IslandTerritories))
p2


# now lets look at raw numbers (rather than proportion of origin) in relation to warming

p3 <- ggplot(data=heat, aes(x=Warming2013, y=Emig2015))
p4 <- p3 + geom_point()
p4

p1 <- ggplot(data = heat, aes( x = heat$Warming2013, y = heat$Emig2015))
p2 <- p1 + geom_point(aes(color = factor(heat$IslandTerritories))) + geom_smooth(mapping = aes( linetype = IslandTerritories))
p2


###
###
###
# Lets just examine the warming data

warming <- ggplot(heat, aes(Warming2013))

warmingdistribution <- warming + geom_histogram()
warmingdistribution

warmingdist <- warming + geom_density()
warmingdist

# now lets look at the distribution of emigraiton ratios
emig <- ggplot(heat, aes(EmigrationRatio))
emigdist <- emig + geom_density()
emigdist

emiglog <- ggplot(heat, aes(log(EmigrationRatio)))
emiglogdist <- emiglog + geom_density()
emiglogdist

##
##
##
# Now lets create new frames for each continent
# and some other interesting subsets

AfricaHeat <- heat [ which (heat$Continent == "Africa"),]

AsiaHeat <- heat [ which (heat$Continent == "Asia"),]

CaribbeanHeat <- heat [ which (heat$Continent == "Caribbean"),]

CAheat <- heat [ which (heat$Continent == "CentralAmerica"),]

EuropeHeat <- heat [ which (heat$Continent == "Europe"),]

MEheat <- heat [ which (heat$Continent == "MiddleEast"),]

NorthAmericaHeat <- heat [ which (heat$Continent == "NorthAmerica"),]

OceaniaHeat <- heat [ which (heat$Continent == "Oceania"),]

SouthAmericaHeat <- heat [ which (heat$Continent == "SouthAmerica"),]

IslandsHeat <- heat [ which (heat$IslandTerritories == "Island"),]

ContinentalHeat <- heat [ which (heat$IslandTerritories == "Continental"),]

##
##
##
# Now lets make scatterplots of heat vs emigration ratio by subset groups

africaemig <- ggplot(AfricaHeat, aes(x=Warming2013, y=EmigrationRatio)) + geom_point() + ggtitle("Africa")
africaemig

asiaemig <- ggplot(AsiaHeat, aes(x=Warming2013, y=EmigrationRatio)) + geom_point() + ggtitle("Asia")
asiaemig

caribemig <- ggplot(CaribbeanHeat, aes(x=Warming2013, y=EmigrationRatio)) + geom_point() + ggtitle("Caribbean")
caribemig

CAemig <- ggplot(CAheat, aes(x=Warming2013, y=EmigrationRatio)) + geom_point() + ggtitle("Central America")
CAemig

eurobemig <- ggplot(EuropeHeat, aes(x=Warming2013, y=EmigrationRatio)) + geom_point() + ggtitle("Europe")
eurobemig

MEemig <- ggplot(MEheat, aes(x=Warming2013, y=EmigrationRatio)) + geom_point() + ggtitle("Middle East")
MEemig

NAemig <- ggplot(NorthAmericaHeat, aes(x=Warming2013, y=EmigrationRatio)) + geom_point() + ggtitle("North America")
NAemig

oceanemig <- ggplot(OceaniaHeat, aes(x=Warming2013, y=EmigrationRatio)) + geom_point() + ggtitle("Oceania")
oceanemig

SAemig <- ggplot(SouthAmericaHeat, aes(x=Warming2013, y=EmigrationRatio)) + geom_point() + ggtitle("South America")
SAemig

islandemig <- ggplot(IslandsHeat, aes(x=Warming2013, y=EmigrationRatio)) + geom_point() + ggtitle("Islands")
islandemig

contemig <- ggplot(ContinentalHeat, aes(x=Warming2013, y=EmigrationRatio)) + geom_point() + ggtitle("Continental")
contemig

##
##
##
# Now we will look at the same data using a smoothing function

africaemigsmooth <- ggplot(AfricaHeat, aes(x=Warming2013, y=EmigrationRatio)) + 
geom_smooth() + xlab("Warming Since 1960 (C)") + 
ylab("Ratio of Emigrants to National Population") + 
ggtitle("African Nations")
africaemigsmooth

asiaemigsmooth <- ggplot(AsiaHeat, aes(x=Warming2013, y=EmigrationRatio)) + 
geom_smooth() + xlab("Warming Since 1960 (C)") + 
ylab("Ratio of Emigrants to National Population") + 
ggtitle("Asian Nations")
asiaemigsmooth

caribemigsmooth <- ggplot(CaribbeanHeat, aes(x=Warming2013, y=EmigrationRatio)) + 
geom_smooth() + xlab("Warming Since 1960 (C)") + 
ylab("Ratio of Emigrants to National Population") + 
ggtitle("Caribbean Nations")
caribemigsmooth

CEemigsmooth <- ggplot(CAheat, aes(x=Warming2013, y=EmigrationRatio)) + 
geom_smooth() + xlab("Warming Since 1960 (C)") + 
ylab("Ratio of Emigrants to National Population") + 
ggtitle("Central American Nations")
CEemigsmooth

euroemigsmooth <- ggplot(EuropeHeat, aes(x=Warming2013, y=EmigrationRatio)) + 
geom_smooth() + xlab("Warming Since 1960 (C)") + 
ylab("Ratio of Emigrants to National Population") + 
ggtitle("European Nations")
euroemigsmooth

MEemigsmooth <- ggplot(MEheat, aes(x=Warming2013, y=EmigrationRatio)) + 
geom_smooth() + xlab("Warming Since 1960 (C)") + 
ylab("Ratio of Emigrants to National Population") + 
ggtitle("Middle Eastern Nations")
MEemigsmooth

NAemigsmooth <- ggplot(NorthAmericaHeat, aes(x=Warming2013, y=EmigrationRatio)) + 
geom_smooth() + xlab("Warming Since 1960 (C)") + 
ylab("Ratio of Emigrants to National Population") + 
ggtitle("North American Nations")
NAemigsmooth

oceanemigsmooth <- ggplot(OceaniaHeat, aes(x=Warming2013, y=EmigrationRatio)) + 
geom_smooth() + xlab("Warming Since 1960 (C)") + 
ylab("Ratio of Emigrants to National Population") + 
ggtitle("Nations in Oceania")
oceanemigsmooth

SAemigsmooth <- ggplot(SouthAmericaHeat, aes(x=Warming2013, y=EmigrationRatio)) + 
geom_smooth() + xlab("Warming Since 1960 (C)") + 
ylab("Ratio of Emigrants to National Population") + 
ggtitle("South American Nations", )
SAemigsmooth

islandemigsmooth <- ggplot(IslandsHeat, aes(x=Warming2013, y=EmigrationRatio)) + 
geom_smooth() + xlab("Warming Since 1960 (C)") + 
ylab("Ratio of Emigrants to National Population") + 
ggtitle("Island Nations", )
islandemigsmooth

contemigsmooth <- ggplot(ContinentalHeat, aes(x=Warming2013, y=EmigrationRatio)) + 
geom_smooth() + xlab("Warming Since 1960 (C)") + 
ylab("Ratio of Emigrants to National Population") + 
ggtitle("Continental Nations", )
contemigsmooth

##
##
##
# And now, lets mace some fact panes separating these out

smoothcore <- ggplot(data=heat, aes(x=Warming2013, y=EmigrationRatio)) + geom_smooth()

smoothcont <- smoothcore + facet_grid (. ~ heat$Continent)
smoothcont

smoothcontislands <- smoothcore + facet_grid (heat$IslandTerritories ~ heat$Continent)
smoothcontislands

